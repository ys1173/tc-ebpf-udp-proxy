# ConfigMap: udp-fanout configuration
#
# IMPORTANT: Update the interface name to match your host NIC
# Check with: kubectl exec -n udp-fanout daemonset/udp-fanout -- ip link show
# Common names: eth0, ens3, eno1, enp0s3

apiVersion: v1
kind: ConfigMap
metadata:
  name: udp-fanout-config
  namespace: udp-fanout
  labels:
    app.kubernetes.io/name: udp-fanout
data:
  config.yaml: |
    listeners:
      # Example: Syslog fanout to Vector receivers
      - name: syslog
        bind: "0.0.0.0:5514"
        interface: eth0                # ← Update to match your host NIC
        mode: tc_ebpf
        kubernetes:
          namespace: logging           # ← Namespace where receivers are deployed
          service: vector-aggregators  # ← Headless Service name
          port: 5514                   # ← Receiver port

    # Health checks: Recommended for production
    # Detects pod failures in ~5-7s (vs k8s default ~40-60s)
    health:
      enabled: true
      interval_secs: 5
      timeout_secs: 2
      protocol: icmp

    # Metrics: Prometheus endpoint
    metrics:
      enabled: true
      bind: "0.0.0.0:9090"
      path: /metrics
